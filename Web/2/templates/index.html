<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>仮想CMD</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; }
        #output { white-space: pre; }
        .tab { display: none; }
        .tab.active { display: block; }
        .tabs { margin-bottom: 10px; }
        .tab-button { cursor: pointer; padding: 5px 10px; margin-right: 5px; background: lightgray; border: none; }
        .tab-button.active { background: gray; color: white; }
        .cmd-section { margin-bottom: 20px; }
    </style>
</head>
<body>
    <h1>仮想CMDを実行</h1>

    <div class="tabs">
        <button class="tab-button active" data-tab="tab1">タブ 1</button>
        <button class="tab-button" data-tab="tab2">タブ 2</button>
        <button class="tab-button" data-tab="tab3">タブ 3</button>
        <button id="add-tab">タブを追加</button>
    </div>

    <div class="tab active" id="tab1">
        <h2>CMD 1</h2>
        <input type="text" name="command" placeholder="コマンドを入力" required>
        <button class="execute">実行</button>
        <pre class="output"></pre>
    </div>

    <div class="tab" id="tab2">
        <h2>CMD 2</h2>
        <input type="text" name="command" placeholder="コマンドを入力">
        <button class="execute">実行</button>
        <pre class="output"></pre>
    </div>

    <div class="tab" id="tab3">
        <h2>CMD 3</h2>
        <input type="text" name="command" placeholder="コマンドを入力">
        <button class="execute">実行</button>
        <pre class="output"></pre>
    </div>

    <script>
        $(document).ready(function() {
            // タブ切り替え
            $('.tab-button').on('click', function() {
                const tabId = $(this).data('tab');
                $('.tab').removeClass('active');
                $('.tab-button').removeClass('active');
                $(this).addClass('active');
                $('#' + tabId).addClass('active');
            });

            // コマンド実行
            $('.execute').on('click', function() {
                const commandInput = $(this).siblings('input[name="command"]');
                const command = commandInput.val();
                const outputArea = $(this).siblings('.output');

                if (command) {
                    // AJAXリクエストを送信
                    $.ajax({
                        url: '/execute',
                        method: 'POST',
                        data: { command: [command] },
                        success: function(response) {
                            outputArea.text(response.output); // 結果を表示
                        },
                        error: function() {
                            outputArea.text('エラーが発生しました。');
                        }
                    });
                }
            });

            // タブを追加する機能
            let tabCount = 3; // 初期のタブ数
            $('#add-tab').on('click', function() {
                tabCount++;
                const newTabId = 'tab' + tabCount;

                // 新しいタブボタンを追加
                $('.tabs').append('<button class="tab-button" data-tab="' + newTabId + '">タブ ' + tabCount + '</button>');
                // 新しいタブを追加
                $('.tab:last').after(`
                    <div class="tab" id="${newTabId}">
                        <h2>CMD ${tabCount}</h2>
                        <input type="text" name="command" placeholder="コマンドを入力">
                        <button class="execute">実行</button>
                        <pre class="output"></pre>
                    </div>
                `);
            });
        });
    </script>
</body>
</html>
